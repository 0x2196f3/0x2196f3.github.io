<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Openwrt on 0x2196f3's blog</title><link>/tags/openwrt/</link><description>0x2196f3's blog (Openwrt)</description><generator>Hugo -- gohugo.io</generator><language>zh-CN</language><lastBuildDate>Tue, 30 Dec 2025 00:00:00 +0000</lastBuildDate><atom:link href="/tags/openwrt/index.xml" rel="self" type="application/rss+xml"/><item><title>Xiaomi AX6000刷OpenWRT</title><link>/posts/xiaomi-ax6000-openwrt/</link><pubDate>Tue, 30 Dec 2025 00:00:00 +0000</pubDate><guid>/posts/xiaomi-ax6000-openwrt/</guid><description>&lt;h1 id="已知问题" >
&lt;div>
&lt;a href="#%e5%b7%b2%e7%9f%a5%e9%97%ae%e9%a2%98">
##
&lt;/a>
已知问题
&lt;/div>
&lt;/h1>
&lt;h2 id="openwrt-25120-rc1已知问题" >
&lt;div>
&lt;a href="#openwrt-25120-rc1%e5%b7%b2%e7%9f%a5%e9%97%ae%e9%a2%98">
#
&lt;/a>
OpenWRT 25.12.0-rc1已知问题
&lt;/div>
&lt;/h2>
&lt;ul>
&lt;li>5Ghz Wifi,信道选auto无法启动,需要手动设置信道为36&lt;/li>
&lt;li>5Ghz Wifi即使开启160mhz也无法协商到超过1200mbps,测速跑不满千兆,对无线速度有要求就再等等&lt;/li>
&lt;li>虽然路由器有128mb闪存,但OpenWRT可用容量仅60mb&lt;/li>
&lt;li>内存占用异常:不装任何插件内存占用300mb+(正常情况下512mb内存应该占用200mb左右)&lt;/li>
&lt;li>以上问题rc2一个都没有修复&lt;/li>
&lt;/ul>
&lt;h2 id="路由器自身的问题" >
&lt;div>
&lt;a href="#%e8%b7%af%e7%94%b1%e5%99%a8%e8%87%aa%e8%ba%ab%e7%9a%84%e9%97%ae%e9%a2%98">
#
&lt;/a>
路由器自身的问题
&lt;/div>
&lt;/h2>
&lt;ul>
&lt;li>这款路由器三个千兆网口共享1G带宽,无线/有线都基本不可能跑满2.5G,不建议&lt;del>为了能刷机&lt;/del>购买.见&lt;a href="https://www.acwifi.net/12621.html">acwifi评测&lt;/a>&lt;/li>
&lt;li>IPQ5018处理器性能较弱(双核1GHZ A53,相当于NanoPi R2s软路由的一半不到),且原版OpenWRT不支持硬件加速,不建议用于拨号/翻墙&lt;/li>
&lt;/ul>
&lt;h2 id="评价" >
&lt;div>
&lt;a href="#%e8%af%84%e4%bb%b7">
#
&lt;/a>
评价
&lt;/div>
&lt;/h2>
&lt;p>Xiaomi AX6000本来就是一款除了无线性能勉强及格其它一无是处的路由器,刷OpenWRT后无线也不及格了,&lt;strong>不建议刷&lt;/strong>&lt;/p>
&lt;h1 id="测速" >
&lt;div>
&lt;a href="#%e6%b5%8b%e9%80%9f">
##
&lt;/a>
测速
&lt;/div>
&lt;/h1>
&lt;ul>
&lt;li>开启Software flow offloading&lt;/li>
&lt;li>内网使用&lt;a href="https://hub.docker.com/r/openspeedtest/latest/">OpenSpeedTest&lt;/a>&lt;/li>
&lt;li>外网使用&lt;a href="https://test.ustc.edu.cn">中科大测速站&lt;/a>&lt;/li>
&lt;li>wan口=2.5G网口&lt;/li>
&lt;/ul>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>测试场景&lt;/th>
&lt;th>速度 (下载/上传)&lt;/th>
&lt;th>备注&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>两个千兆 LAN 口之间测速&lt;/td>
&lt;td>&lt;strong>1000 Mbps / 1000 Mbps&lt;/strong>&lt;/td>
&lt;td>推测流量在交换芯片内部处理未经过CPU&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>千兆 LAN 口向 WAN 公网测速&lt;/td>
&lt;td>&lt;strong>650 Mbps / NA&lt;/strong>&lt;/td>
&lt;td>达到宽带上限&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>千兆 LAN 口向 WAN 服务器测速&lt;/td>
&lt;td>&lt;strong>920 Mbps / 700 Mbps&lt;/strong>&lt;/td>
&lt;td>-&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>5 GHz WiFi 向 LAN 口测速&lt;/td>
&lt;td>&lt;strong>350 Mbps / 500 Mbps&lt;/strong>&lt;/td>
&lt;td>-&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>5 GHz WiFi 向 WAN 公网测速&lt;/td>
&lt;td>&lt;strong>350 Mbps / NA&lt;/strong>&lt;/td>
&lt;td>-&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>5 GHz WiFi 向 WAN 服务器测速&lt;/td>
&lt;td>&lt;strong>730 Mbps / 500 Mbps&lt;/strong>&lt;/td>
&lt;td>-&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>测了很多遍,确实是这种奇怪的结果,我不知道原因&lt;/p>
&lt;p>5Ghz Wifi目前肯定工作不正常,但只要固件不支持Qualcommax NSS(高通硬件加速),这么烂的CPU能不能跑满5Ghz Wifi或千兆网络依然是问题.&lt;/p>
&lt;h1 id="刷机步骤" >
&lt;div>
&lt;a href="#%e5%88%b7%e6%9c%ba%e6%ad%a5%e9%aa%a4">
##
&lt;/a>
刷机步骤
&lt;/div>
&lt;/h1>
&lt;h2 id="0降级到1055-optional" >
&lt;div>
&lt;a href="#0%e9%99%8d%e7%ba%a7%e5%88%b01055-optional">
#
&lt;/a>
0.降级到1.0.55 (Optional)
&lt;/div>
&lt;/h2>
&lt;blockquote>
&lt;p>有些新生产的Xiaomi AX6000路由器无法降级到低版本,可能是因为硬件规格改变(缩水)但没有更换型号,可以先在当前版本尝试解锁ssh,失败再降级&lt;/p>&lt;/blockquote>
&lt;p>&lt;a href="https://mirom.ezbox.idv.tw/miwifi/RA72/roms-stable/">Xiaomi AX6000历史固件下载&lt;/a>&lt;/p>
&lt;p>实测我自己的路由器可以从最新稳定版(1.0.122)直接降级到1.0.55&lt;/p>
&lt;h2 id="1使用xmir-patcher解锁ssh" >
&lt;div>
&lt;a href="#1%e4%bd%bf%e7%94%a8xmir-patcher%e8%a7%a3%e9%94%81ssh">
#
&lt;/a>
1.使用&lt;a href="https://github.com/openwrt-xiaomi/xmir-patcher">xmir-patcher&lt;/a>解锁ssh
&lt;/div>
&lt;/h2>
&lt;ul>
&lt;li>网上搜到的教程解锁ssh需要装OpenWRT虚拟机开无线热点,现在xmir-patcher开箱即用,不需要管理员权限,可以自动获取sn/计算root密码/开启ssh/备份固件/刷机&amp;hellip;&lt;/li>
&lt;/ul>
&lt;p>下载并解压&lt;a href="https://github.com/openwrt-xiaomi/xmir-patcher/archive/refs/heads/main.zip">源码.zip&lt;/a>,点击&lt;code>run.bat&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cmd" data-lang="cmd">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>==========================================================
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Xiaomi MiR Patcher
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 1 - Set IP-address (current value: 192.168.31.1)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 2 - Connect to device (install exploit)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 3 - Read full device info
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 4 - Create full backup
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 5 - Install EN/RU languages
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 6 - Install permanent SSH
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 7 - Install firmware (from directory &lt;span style="color:#e6db74">&amp;#34;firmware&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 8 - {{{ Other functions }}}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 9 - [[ Reboot device ]]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 0 - Exit
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Select:
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>使用网线或wifi连接到小米路由器&lt;br>
选2 解锁ssh&lt;/p>
&lt;h2 id="2备份" >
&lt;div>
&lt;a href="#2%e5%a4%87%e4%bb%bd">
#
&lt;/a>
2.备份
&lt;/div>
&lt;/h2>
&lt;p>选4 备份闪存内容,刷回原版可能有用,但变砖可能要拆机救&lt;br>
选6 固化ssh&lt;/p>
&lt;h2 id="3下载openwrt固件" >
&lt;div>
&lt;a href="#3%e4%b8%8b%e8%bd%bdopenwrt%e5%9b%ba%e4%bb%b6">
#
&lt;/a>
3.下载Openwrt固件
&lt;/div>
&lt;/h2>
&lt;p>&lt;a href="https://firmware-selector.openwrt.org/">openwrt firmware-selector&lt;/a>
选择Xiaomi AX6000, 25.12.x&lt;/p>
&lt;p>下载第一个&lt;strong>SYSTEMUPGRADE&lt;/strong> (xxx-squashfs-sysupgrade.bin)&lt;br>
和第三个&lt;strong>INITRAMFS-FACTORY&lt;/strong> (xxx-initramfs-factory.ubi)&lt;/p>
&lt;h2 id="4刷机" >
&lt;div>
&lt;a href="#4%e5%88%b7%e6%9c%ba">
#
&lt;/a>
4.刷机
&lt;/div>
&lt;/h2>
&lt;p>将&lt;code>...-initramfs-factory.ubi&lt;/code>放入&lt;code>./xmir-patcher-main/firmware&lt;/code>&lt;/p>
&lt;p>选7 刷机&lt;/p>
&lt;ul>
&lt;li>OpenWRT默认不开启WIFI,必须连网线&lt;/li>
&lt;li>OpenWRT默认ip是&lt;code>192.168.1.1&lt;/code>,首次开机不要接上游避免ip冲突&lt;/li>
&lt;/ul>
&lt;p>重启连接网线到lan口(三个千兆口的任意一个),浏览器输入&lt;code>192.168.1.1&lt;/code>即可进入luci界面,没有密码.&lt;/p>
&lt;p>在System -&amp;gt; Backup / Flash Firmware -&amp;gt; Flash Image&lt;br>
刷入&lt;code>...-squashfs-sysupgrade.bin&lt;/code>&lt;/p>
&lt;p>重启&lt;/p>
&lt;h2 id="5刷回原厂系统" >
&lt;div>
&lt;a href="#5%e5%88%b7%e5%9b%9e%e5%8e%9f%e5%8e%82%e7%b3%bb%e7%bb%9f">
#
&lt;/a>
5.刷回原厂系统
&lt;/div>
&lt;/h2>
&lt;ol start="0">
&lt;li>下载&lt;a href="https://bigota.miwifi.com/xiaoqiang/tools/MIWIFIRepairTool.x86.zip">MIWIFIRepairTool.zip&lt;/a>和&lt;a href="https://mirom.ezbox.idv.tw/miwifi/RA72/roms-stable/">最新固件&lt;/a>&lt;/li>
&lt;li>电脑有线网口连接第一个千兆lan口&lt;/li>
&lt;li>打开&lt;code>MIWIFIRepairTool.x86.exe&lt;/code>,手动上传最新固件(&lt;code>.bin&lt;/code>格式),选择连接路由器的网卡,一路下一步&lt;/li>
&lt;li>按住reset按钮时插入路由器电源,reset一直按住不放直到路由器橙灯闪烁,松开,开始刷机&lt;/li>
&lt;li>等几分钟,路由器快速闪白灯后拔电重启(和工具里说的亮蓝灯不一样)&lt;/li>
&lt;/ol>
&lt;h1 id="参考" >
&lt;div>
&lt;a href="#%e5%8f%82%e8%80%83">
##
&lt;/a>
参考
&lt;/div>
&lt;/h1>
&lt;p>&lt;a href="https://www.bilibili.com/opus/1079010971533443094">小米 AX6000 刷 OpenWrt&lt;/a>&lt;/p></description></item><item><title>OpenWrt扩容</title><link>/posts/openwrt-expand-root/</link><pubDate>Mon, 27 Oct 2025 00:00:00 +0000</pubDate><guid>/posts/openwrt-expand-root/</guid><description>&lt;h1 id="openwrt扩容" >
&lt;div>
&lt;a href="#openwrt%e6%89%a9%e5%ae%b9">
##
&lt;/a>
OpenWrt扩容
&lt;/div>
&lt;/h1>
&lt;p>原文: &lt;a href="https://openwrt.org/docs/guide-user/advanced/expand_root">Expanding root partition and filesystem&lt;/a>&lt;/p>
&lt;ul>
&lt;li>很多教程说扩容仅支持EXT4,不支持SquashFS,实测OpenWRT24.10 SquashFS可以扩容&lt;/li>
&lt;li>很多教程说扩容后无法更新系统,虽然原文说可以在更新后自动把扩容脚本再执行一遍,但没说原来的数据会怎么样.我没试过,最好不要更新系统.&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>cd /tmp
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Install packages&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>opkg update
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>opkg install parted losetup resize2fs blkid
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Download expand-root.sh&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>wget -U &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span> -O expand-root.sh &lt;span style="color:#e6db74">&amp;#34;https://openwrt.org/_export/code/docs/guide-user/advanced/expand_root?codeblock=0&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Source the script (creates /etc/uci-defaults/70-rootpt-resize and /etc/uci-defaults/80-rootpt-resize, and adds them to /etc/sysupgrade.conf so they will be re-run after a sysupgrade)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>. ./expand-root.sh
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Resize root partition and filesystem (will resize partiton, reboot resize filesystem, and reboot again)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sh /etc/uci-defaults/70-rootpt-resize
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;p>这段脚本做了什么?&lt;/p>&lt;/blockquote>
&lt;ol start="0">
&lt;li>扩容&lt;/li>
&lt;li>将扩容脚本写入到&lt;code>/etc/uci-defaults/70-rootpt-resize&lt;/code>和&lt;code>/etc/uci-defaults/80-rootfs-resize&lt;/code>&lt;/li>
&lt;li>自动设置在系统更新后保留这两个脚本(luci界面&lt;code>System -&amp;gt; Backup / Flash Firmware / Configuration&lt;/code>可查)&lt;/li>
&lt;li>但没有将这两个脚本写入&lt;code>/etc/sysupgrade.conf&lt;/code>(这个文件甚至不存在).&lt;/li>
&lt;/ol>
&lt;p>所以默认自动更新后应该不会扩容&lt;/p></description></item><item><title>OpenWrt设置usb扩容</title><link>/posts/openwrt-set-usb-overlay/</link><pubDate>Mon, 27 Oct 2025 00:00:00 +0000</pubDate><guid>/posts/openwrt-set-usb-overlay/</guid><description>&lt;h1 id="openwrt设置usb扩容" >
&lt;div>
&lt;a href="#openwrt%e8%ae%be%e7%bd%aeusb%e6%89%a9%e5%ae%b9">
##
&lt;/a>
OpenWrt设置usb扩容
&lt;/div>
&lt;/h1>
&lt;p>&lt;a href="https://openwrt.org/docs/guide-user/additional-software/extroot_configuration">原文&lt;/a>&lt;/p>
&lt;h2 id="连接ssh" >
&lt;div>
&lt;a href="#%e8%bf%9e%e6%8e%a5ssh">
#
&lt;/a>
连接SSH
&lt;/div>
&lt;/h2>
&lt;h2 id="安装软件包" >
&lt;div>
&lt;a href="#%e5%ae%89%e8%a3%85%e8%bd%af%e4%bb%b6%e5%8c%85">
#
&lt;/a>
安装软件包
&lt;/div>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>opkg update
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>opkg install block-mount kmod-fs-ext4 e2fsprogs parted kmod-usb-storage
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="查看usb设备位置" >
&lt;div>
&lt;a href="#%e6%9f%a5%e7%9c%8busb%e8%ae%be%e5%a4%87%e4%bd%8d%e7%bd%ae">
#
&lt;/a>
查看USB设备位置
&lt;/div>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>ls -l /sys/block
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>如果是无线路由器只有一个外接存储，大概率是&lt;code>sda&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>lrwxrwxrwx &lt;span style="color:#ae81ff">1&lt;/span> root root &lt;span style="color:#ae81ff">0&lt;/span> xxx xx xx:xx sda -&amp;gt; ../devices/xxx/block/sda
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="在usb上创建分区格式化设置exroot并自动挂载" >
&lt;div>
&lt;a href="#%e5%9c%a8usb%e4%b8%8a%e5%88%9b%e5%bb%ba%e5%88%86%e5%8c%ba%e6%a0%bc%e5%bc%8f%e5%8c%96%e8%ae%be%e7%bd%aeexroot%e5%b9%b6%e8%87%aa%e5%8a%a8%e6%8c%82%e8%bd%bd">
#
&lt;/a>
在USB上创建分区，格式化，设置exroot并自动挂载
&lt;/div>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#Partitioning and formatting&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>DISK&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;/dev/sda&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>parted -s &lt;span style="color:#e6db74">${&lt;/span>DISK&lt;span style="color:#e6db74">}&lt;/span> -- mklabel gpt mkpart extroot 2048s -2048s
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>DEVICE&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>DISK&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">1&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>mkfs.ext4 -L extroot &lt;span style="color:#e6db74">${&lt;/span>DEVICE&lt;span style="color:#e6db74">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#Configuring extroot&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>eval &lt;span style="color:#66d9ef">$(&lt;/span>block info &lt;span style="color:#e6db74">${&lt;/span>DEVICE&lt;span style="color:#e6db74">}&lt;/span> | grep -o -e &lt;span style="color:#e6db74">&amp;#39;UUID=&amp;#34;\S*&amp;#34;&amp;#39;&lt;/span>&lt;span style="color:#66d9ef">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>eval &lt;span style="color:#66d9ef">$(&lt;/span>block info | grep -o -e &lt;span style="color:#e6db74">&amp;#39;MOUNT=&amp;#34;\S*/overlay&amp;#34;&amp;#39;&lt;/span>&lt;span style="color:#66d9ef">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>uci -q delete fstab.extroot
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>uci set fstab.extroot&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;mount&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>uci set fstab.extroot.uuid&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>UUID&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>uci set fstab.extroot.target&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>MOUNT&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>uci commit fstab
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#Configuring rootfs_data / ubifs&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ORIG&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#66d9ef">$(&lt;/span>block info | sed -n -e &lt;span style="color:#e6db74">&amp;#39;/MOUNT=&amp;#34;\S*\/overlay&amp;#34;/s/:\s.*$//p&amp;#39;&lt;/span>&lt;span style="color:#66d9ef">)&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>uci -q delete fstab.rwm
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>uci set fstab.rwm&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;mount&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>uci set fstab.rwm.device&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>ORIG&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>uci set fstab.rwm.target&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;/rwm&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>uci commit fstab
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>按y，一路回车&lt;/p>
&lt;h2 id="复制内置闪存的文件" >
&lt;div>
&lt;a href="#%e5%a4%8d%e5%88%b6%e5%86%85%e7%bd%ae%e9%97%aa%e5%ad%98%e7%9a%84%e6%96%87%e4%bb%b6">
#
&lt;/a>
复制内置闪存的文件
&lt;/div>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>mount &lt;span style="color:#e6db74">${&lt;/span>DEVICE&lt;span style="color:#e6db74">}&lt;/span> /mnt
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>tar -C &lt;span style="color:#e6db74">${&lt;/span>MOUNT&lt;span style="color:#e6db74">}&lt;/span> -cvf - . | tar -C /mnt -xf -
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>此时检查software的可用容量应该是U盘的容量了&lt;/p>
&lt;ul>
&lt;li>实测直接拔掉U盘重启就会自动使用内置的闪存启动,不需要任何配置&lt;/li>
&lt;li>安装系统更新不确定会发生什么,最好不要这么做&lt;/li>
&lt;/ul></description></item><item><title>OpenWrt 修改Kernel Hash安装官方源kmod-ipk</title><link>/posts/openwrt-change-kernel-hash/</link><pubDate>Tue, 01 Jul 2025 00:00:00 +0000</pubDate><guid>/posts/openwrt-change-kernel-hash/</guid><description>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>vi /usr/lib/opkg/status
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># replace hash_a by hash_b&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>:%s/hash_a/hash_b/g
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>hash_a 是 /usr/lib/opkg/status 里的hash值&lt;br>
hash_b 是安装ipk报错时提示的hash值&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># save&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>:wq
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item></channel></rss>